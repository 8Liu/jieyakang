<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.liudehuang.jieyakang.member.dao.MemberLoginDao">
    <sql id="member_table">t_member</sql>

    <resultMap id="memberMap" type="com.liudehuang.jieyakang.member.entity.dto.UserInfoDTO">
        <result property="openId" column="openid"/>
        <result property="nickName" column="nickname"/>
        <result property="gender" column="gender"/>
        <result property="language" column="language"/>
        <result property="city" column="city"/>
        <result property="province" column="province"/>
        <result property="country" column="country"/>
        <result property="avatarUrl" column="avatarUrl"/>
        <result property="unionId" column="unionId"/>
    </resultMap>

    <insert id="registerMember" parameterType="com.liudehuang.jieyakang.member.entity.dto.UserInfoDTO">
        insert into<include refid="member_table"/>(
        openid,
        nickname,
        gender,
        language,
        city,
        province,
        country,
        avatarUrl,
        unionId
        )values (
        #{openId},
        #{nickName},
        #{gender},
        #{language},
        #{city},
        #{province},
        #{country},
        #{avatarUrl},
        #{unionId}
        )
    </insert>

    <select id="getUserInfo" parameterType="string" resultMap="memberMap">
        select
          openid,
          nickname,
          gender,
          language,
          city,
          province,
          country,
          avatarUrl,
          unionId,
          DATE_FORMAT(createtime,'%Y-%m-%d %H:%i:%s') as createtime,
          DATE_FORMAT(updatetime,'%Y-%m-%d %H:%i:%s') as updatetime
        from <include refid="member_table"/>
        where openid = #{openId}
    </select>
</mapper>